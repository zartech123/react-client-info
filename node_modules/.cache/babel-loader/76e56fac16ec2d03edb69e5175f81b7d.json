{"ast":null,"code":"'use strict';\n\nvar _objectSpread = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/objectSpread2\");\n\nvar _regeneratorRuntime = require(\"/home/satubenih/node_modules/@babel/runtime/regenerator\");\n\nvar _createForOfIteratorHelper = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/createForOfIteratorHelper\");\n\nvar _asyncToGenerator = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/asyncToGenerator\");\n\nvar _classCallCheck = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/classCallCheck\");\n\nvar _createClass = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/createClass\");\n\nvar _inherits = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/inherits\");\n\nvar _createSuper = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/createSuper\");\n\nvar _wrapNativeSuper = require(\"/home/satubenih/node_modules/@babel/runtime/helpers/wrapNativeSuper\");\n\nvar isIp = require('is-ip');\n\nvar CancelError = /*#__PURE__*/function (_Error) {\n  _inherits(CancelError, _Error);\n\n  var _super = _createSuper(CancelError);\n\n  function CancelError() {\n    var _this;\n\n    _classCallCheck(this, CancelError);\n\n    _this = _super.call(this, 'Request was cancelled');\n    _this.name = 'CancelError';\n    return _this;\n  }\n\n  _createClass(CancelError, [{\n    key: \"isCanceled\",\n    get: function get() {\n      return true;\n    }\n  }]);\n\n  return CancelError;\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n\nvar defaults = {\n  timeout: 5000\n};\nvar urls = {\n  v4: ['https://ipv4.icanhazip.com/', 'https://api.ipify.org/'],\n  v6: ['https://ipv6.icanhazip.com/', 'https://api6.ipify.org/']\n};\n\nvar sendXhr = function sendXhr(url, options, version) {\n  var xhr = new XMLHttpRequest();\n\n  var _reject;\n\n  var promise = new Promise(function (resolve, reject) {\n    _reject = reject;\n    xhr.addEventListener('error', reject, {\n      once: true\n    });\n    xhr.addEventListener('timeout', reject, {\n      once: true\n    });\n    xhr.addEventListener('load', function () {\n      var ip = xhr.responseText.trim();\n\n      if (!ip || !isIp[version](ip)) {\n        reject();\n        return;\n      }\n\n      resolve(ip);\n    }, {\n      once: true\n    });\n    xhr.open('GET', url);\n    xhr.timeout = options.timeout;\n    xhr.send();\n  });\n\n  promise.cancel = function () {\n    xhr.abort();\n\n    _reject(new CancelError());\n  };\n\n  return promise;\n};\n\nvar queryHttps = function queryHttps(version, options) {\n  var request;\n\n  var promise = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var urls_, _iterator, _step, url, ip;\n\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            urls_ = [].concat.apply(urls[version], options.fallbackUrls || []);\n            _iterator = _createForOfIteratorHelper(urls_);\n            _context.prev = 2;\n\n            _iterator.s();\n\n          case 4:\n            if ((_step = _iterator.n()).done) {\n              _context.next = 20;\n              break;\n            }\n\n            url = _step.value;\n            _context.prev = 6;\n            request = sendXhr(url, options, version); // eslint-disable-next-line no-await-in-loop\n\n            _context.next = 10;\n            return request;\n\n          case 10:\n            ip = _context.sent;\n            return _context.abrupt(\"return\", ip);\n\n          case 14:\n            _context.prev = 14;\n            _context.t0 = _context[\"catch\"](6);\n\n            if (!(_context.t0 instanceof CancelError)) {\n              _context.next = 18;\n              break;\n            }\n\n            throw _context.t0;\n\n          case 18:\n            _context.next = 4;\n            break;\n\n          case 20:\n            _context.next = 25;\n            break;\n\n          case 22:\n            _context.prev = 22;\n            _context.t1 = _context[\"catch\"](2);\n\n            _iterator.e(_context.t1);\n\n          case 25:\n            _context.prev = 25;\n\n            _iterator.f();\n\n            return _context.finish(25);\n\n          case 28:\n            throw new Error('Couldn\\'t find your IP');\n\n          case 29:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee, null, [[2, 22, 25, 28], [6, 14]]);\n  }))();\n\n  promise.cancel = function () {\n    request.cancel();\n  };\n\n  return promise;\n};\n\nmodule.exports.v4 = function (options) {\n  return queryHttps('v4', _objectSpread(_objectSpread({}, defaults), options));\n};\n\nmodule.exports.v6 = function (options) {\n  return queryHttps('v6', _objectSpread(_objectSpread({}, defaults), options));\n};","map":{"version":3,"sources":["/home/satubenih/node_modules/public-ip/browser.js"],"names":["isIp","require","CancelError","name","Error","defaults","timeout","urls","v4","v6","sendXhr","url","options","version","xhr","XMLHttpRequest","_reject","promise","Promise","resolve","reject","addEventListener","once","ip","responseText","trim","open","send","cancel","abort","queryHttps","request","urls_","concat","apply","fallbackUrls","module","exports"],"mappings":"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","sourcesContent":["'use strict';\nconst isIp = require('is-ip');\n\nclass CancelError extends Error {\n\tconstructor() {\n\t\tsuper('Request was cancelled');\n\t\tthis.name = 'CancelError';\n\t}\n\n\tget isCanceled() {\n\t\treturn true;\n\t}\n}\n\nconst defaults = {\n\ttimeout: 5000\n};\n\nconst urls = {\n\tv4: [\n\t\t'https://ipv4.icanhazip.com/',\n\t\t'https://api.ipify.org/'\n\t],\n\tv6: [\n\t\t'https://ipv6.icanhazip.com/',\n\t\t'https://api6.ipify.org/'\n\t]\n};\n\nconst sendXhr = (url, options, version) => {\n\tconst xhr = new XMLHttpRequest();\n\n\tlet _reject;\n\tconst promise = new Promise((resolve, reject) => {\n\t\t_reject = reject;\n\t\txhr.addEventListener('error', reject, {once: true});\n\t\txhr.addEventListener('timeout', reject, {once: true});\n\n\t\txhr.addEventListener('load', () => {\n\t\t\tconst ip = xhr.responseText.trim();\n\n\t\t\tif (!ip || !isIp[version](ip)) {\n\t\t\t\treject();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tresolve(ip);\n\t\t}, {once: true});\n\n\t\txhr.open('GET', url);\n\t\txhr.timeout = options.timeout;\n\t\txhr.send();\n\t});\n\n\tpromise.cancel = () => {\n\t\txhr.abort();\n\t\t_reject(new CancelError());\n\t};\n\n\treturn promise;\n};\n\nconst queryHttps = (version, options) => {\n\tlet request;\n\tconst promise = (async function () {\n\t\tconst urls_ = [].concat.apply(urls[version], options.fallbackUrls || []);\n\t\tfor (const url of urls_) {\n\t\t\ttry {\n\t\t\t\trequest = sendXhr(url, options, version);\n\t\t\t\t// eslint-disable-next-line no-await-in-loop\n\t\t\t\tconst ip = await request;\n\t\t\t\treturn ip;\n\t\t\t} catch (error) {\n\t\t\t\tif (error instanceof CancelError) {\n\t\t\t\t\tthrow error;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tthrow new Error('Couldn\\'t find your IP');\n\t})();\n\n\tpromise.cancel = () => {\n\t\trequest.cancel();\n\t};\n\n\treturn promise;\n};\n\nmodule.exports.v4 = options => queryHttps('v4', {...defaults, ...options});\n\nmodule.exports.v6 = options => queryHttps('v6', {...defaults, ...options});\n"]},"metadata":{},"sourceType":"script"}